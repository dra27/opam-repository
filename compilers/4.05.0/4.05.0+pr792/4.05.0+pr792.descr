Fixing the limitations on destructive substitutions
Target branch: trunk