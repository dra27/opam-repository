Fix the behavior of Unix.read on Windows + Makefile changes
Target branch: trunk