opam-version: "2.0"
synopsis: "Zeroth alpha release of OCaml 5.0.0"
maintainer: "platform@lists.ocaml.org"
license: "LGPL-2.1-or-later WITH OCaml-LGPL-linking-exception"
authors: "Xavier Leroy and many contributors"
homepage: "https://ocaml.org"
bug-reports: "https://github.com/ocaml/opam-repository/issues"
dev-repo: "git+https://github.com/ocaml/ocaml#5.0"
depends: [
  "ocaml" {= "5.0.0" & post}
  "base-unix" {post}
  "base-bigarray" {post}
  "base-threads" {post}
  "base-domains" {post}
  "base-nnp" {post}
  "ocaml-options-vanilla" {post}
  "ocaml-beta" {opam-version < "2.1.0"}
]
conflict-class: "ocaml-core-compiler"
flags: [ compiler avoid-version ]
setenv: CAML_LD_LIBRARY_PATH = "%{lib}%/stublibs"
build: [
  [
    "./configure"
    "--prefix=%{prefix}%"
    "--docdir=%{doc}%/ocaml"
    "-C"
    "CC=cc" {os = "openbsd" | os = "macos"}
    "ASPP=cc -c" {os = "openbsd" | os = "macos"}
  ]
  [make "-j%{jobs}%"]
]
install: [make "install"]
url {
  src: "https://github.com/ocaml/ocaml/archive/5.0.0-alpha0.tar.gz"
  checksum: "sha256=70f5353001ba95dff96f71680a435e1e7d3708eddb1fd8c74b9e18a292fe40ce"
}
extra-files: ["ocaml-base-compiler.install" "md5=3e969b841df1f51ca448e6e6295cb451"]
post-messages: [
  "Thank you for testing OCaml 5.0!

   During the release cycle, there can be a lag between packages being fixed for
   compatibility with the latest release of OCaml and an actual package-release
   being made to opam-repository. You may wish to add opam-alpha-repository to
   your switch by issuing:

   opam repo add alpha git+https://github.com/ocaml/opam-alpha-repository

   This will enable patched, but unreleased, versions of some packages which are
   used for automated testing and made available to aid development and testing of
   the new release. These packages are automatically upgraded when a new upstream
   release is made to the official opam-repository."
]
